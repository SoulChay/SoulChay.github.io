<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="1.RPC简介RPC（Remote Procedure Call）远程调用协议。RPC协议规定允许互联网中一台主机调用另一台主机的程序，而程序员无需对这个交互过程进行编程。在RPC协议中强调当A程序调用B程序中的功能或方法时，A是不知道B中方法的实现的。 RPC是上层协议，底层可以基于TCP协议，也可以基于HTTP协议。一般我们说RPC都是基于RPC的具体实现，如：Dubbo框架。从广义上来讲只要">
<meta property="og:type" content="article">
<meta property="og:title" content="Rpc巩固">
<meta property="og:url" content="http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/index.html">
<meta property="og:site_name" content="22Cheney.">
<meta property="og:description" content="1.RPC简介RPC（Remote Procedure Call）远程调用协议。RPC协议规定允许互联网中一台主机调用另一台主机的程序，而程序员无需对这个交互过程进行编程。在RPC协议中强调当A程序调用B程序中的功能或方法时，A是不知道B中方法的实现的。 RPC是上层协议，底层可以基于TCP协议，也可以基于HTTP协议。一般我们说RPC都是基于RPC的具体实现，如：Dubbo框架。从广义上来讲只要">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc1.png">
<meta property="og:image" content="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc2.png">
<meta property="og:image" content="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc3.png">
<meta property="og:image" content="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc4.png">
<meta property="article:published_time" content="2022-03-21T16:00:00.000Z">
<meta property="article:modified_time" content="2022-05-24T03:31:39.099Z">
<meta property="article:author" content="Soulchay">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc1.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Rpc巩固</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="22Cheney." type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2022/04/30/CMS&G1-%E5%85%AB%E8%82%A1%E6%96%87/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/03/13/RPC(Zookeeper%20&%20RMI)/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&text=Rpc巩固"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&is_video=false&description=Rpc巩固"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Rpc巩固&body=Check out this article: http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&name=Rpc巩固&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&t=Rpc巩固"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>

    
    <div id="toc" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-RPC%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">1.RPC简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-RPC%E5%92%8CHTTP%E5%AF%B9%E6%AF%94"><span class="toc-number">2.</span> <span class="toc-text">2.RPC和HTTP对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.1.</span> <span class="toc-text">2.1具体实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E6%95%88%E7%8E%87"><span class="toc-number">2.2.</span> <span class="toc-text">2.2效率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">2.3.</span> <span class="toc-text">2.3连接方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4%E6%80%A7%E8%83%BD"><span class="toc-number">2.4.</span> <span class="toc-text">2.4性能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83"><span class="toc-number">2.5.</span> <span class="toc-text">2.5注册中心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">2.6.</span> <span class="toc-text">2.6负载均衡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7%E6%80%BB%E7%BB%93"><span class="toc-number">2.7.</span> <span class="toc-text">2.7总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-HttpClient%E5%AE%9E%E7%8E%B0RPC"><span class="toc-number">3.</span> <span class="toc-text">3.HttpClient实现RPC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1HttpClient%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.</span> <span class="toc-text">3.1HttpClient简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.2.</span> <span class="toc-text">3.2模拟实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1%E6%97%A0%E5%8F%82%E6%95%B0Get%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1无参数Get请求模拟</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2%E5%B8%A6%E5%8F%82%E6%95%B0Get%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2带参数Get请求模拟</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3%E6%97%A0%E5%8F%82%E6%95%B0Post%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3无参数Post请求模拟</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4%E5%B8%A6%E5%8F%82%E6%95%B0Post%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.4.</span> <span class="toc-text">3.2.4带参数Post请求模拟</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-RMI%E5%AE%9E%E7%8E%B0RPC"><span class="toc-number">4.</span> <span class="toc-text">4.RMI实现RPC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-RMI%E7%AE%80%E4%BB%8B"><span class="toc-number">4.1.</span> <span class="toc-text">1.RMI简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">4.2.</span> <span class="toc-text">2.执行流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.3.</span> <span class="toc-text">3.工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85"><span class="toc-number">4.3.1.</span> <span class="toc-text">3.1基础知识补充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2Client-amp-Server"><span class="toc-number">4.3.2.</span> <span class="toc-text">3.2Client&amp;Server</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3RMIRegistry"><span class="toc-number">4.3.3.</span> <span class="toc-text">3.3RMIRegistry</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.4.</span> <span class="toc-text">4.模拟实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%8E%A5%E5%8F%A3"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.1服务端接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">4.4.2.</span> <span class="toc-text">4.2服务端实现类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%B8%BB%E6%96%B9%E6%B3%95"><span class="toc-number">4.4.3.</span> <span class="toc-text">4.3服务端主方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%BB%E6%96%B9%E6%B3%95"><span class="toc-number">4.4.4.</span> <span class="toc-text">4.4客户端主方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%87%AA%E5%AE%9A%E4%B9%89-RPC-%E6%A1%86%E6%9E%B6"><span class="toc-number">5.</span> <span class="toc-text">5. 自定义 RPC 框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%8F%82%E8%80%83"><span class="toc-number">6.</span> <span class="toc-text">6.参考</span></a></li></ol>
      
    </div>
  </span>

  

</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Rpc巩固
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Soulchay</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-03-21T16:00:00.000Z" itemprop="datePublished">2022-03-22</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Java/" rel="tag">Java</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="1-RPC简介"><a href="#1-RPC简介" class="headerlink" title="1.RPC简介"></a>1.RPC简介</h2><p>RPC（Remote Procedure Call）远程调用协议。RPC协议规定允许互联网中一台主机调用另一台主机的程序，而程序员无需对这个交互过程进行编程。在RPC协议中强调<b>当A程序调用B程序中的功能或方法时，A是不知道B中方法的实现的</b>。</p>
<p>RPC是上层协议，底层可以基于TCP协议，也可以基于HTTP协议。一般我们说RPC都是基于RPC的具体实现，如：Dubbo框架。从广义上来讲只要是满足网络中进行通讯调用的都统称为RPC，甚至基于HTTP协议都可以说是RPC的具体实现，但是具体分析来看RPC协议要比HTTP协议更加高效，基于RPC的框架功能更多。</p>
<p>RPC协议是基于分布式架构而出现的，所以RPC在分布式项目中有得天独厚的优势。</p>
<h2 id="2-RPC和HTTP对比"><a href="#2-RPC和HTTP对比" class="headerlink" title="2.RPC和HTTP对比"></a>2.RPC和HTTP对比</h2><h3 id="2-1具体实现"><a href="#2-1具体实现" class="headerlink" title="2.1具体实现"></a>2.1具体实现</h3><p>RPC：可以基于TCP协议，也可以基于HTTP协议。（传输层 + 应用层）</p>
<p>HTTP：基于HTTP协议。（应用层）</p>
<h3 id="2-2效率"><a href="#2-2效率" class="headerlink" title="2.2效率"></a>2.2效率</h3><p>RPC：自定义具体实现可以减少很多无用的报文内容，使得报文体积更小。</p>
<p>HTTP：如果是HTTP1.1 报文中内容固定，传递的报文对于客户端而言有些是无用的。如果是HTTP2.0 以后的版本和RPC相差不大，比RPC少的可能就是一些服务治理等功能。</p>
<h3 id="2-3连接方式"><a href="#2-3连接方式" class="headerlink" title="2.3连接方式"></a>2.3连接方式</h3><p>RPC：长连接支持</p>
<p>HTTP：前期不支持长连接，每次建立连接都需要3次握手，断开连接需要4次挥手。HTTP2.0后增加了连接池，可以支持长连接。</p>
<p><img src="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc1.png"></img></p>
<h3 id="2-4性能"><a href="#2-4性能" class="headerlink" title="2.4性能"></a>2.4性能</h3><p>RPC：可以基于很多序列化方式（可以支持字节，也可以支持文本）</p>
<p>HTTP：主要是通过JSON，序列化和反序列化效率更低（超文本传输协议，支持文本）</p>
<h3 id="2-5注册中心"><a href="#2-5注册中心" class="headerlink" title="2.5注册中心"></a>2.5注册中心</h3><p>RPC：一般RPC框架都带有注册中心</p>
<p>HTTP：直接连接</p>
<h3 id="2-6负载均衡"><a href="#2-6负载均衡" class="headerlink" title="2.6负载均衡"></a>2.6负载均衡</h3><p>RPC：绝大多数RPC框架都带有负载均衡</p>
<p>HTTP：一般都需要第三方工具。如：nginx</p>
<h3 id="2-7总结"><a href="#2-7总结" class="headerlink" title="2.7总结"></a>2.7总结</h3><p>RPC框架一般都带有丰富的服务治理等功能，更适合企业内部接口调用。而HTTP更适合多平台之间互相调用。例如：某人在京东秒杀商品，采用的是HTTP协议；而点击秒杀按钮后，京东内部采用的是RPC协议，我们并不了解秒杀按钮的具体做了什么。</p>
<h2 id="3-HttpClient实现RPC"><a href="#3-HttpClient实现RPC" class="headerlink" title="3.HttpClient实现RPC"></a>3.HttpClient实现RPC</h2><h3 id="3-1HttpClient简介"><a href="#3-1HttpClient简介" class="headerlink" title="3.1HttpClient简介"></a>3.1HttpClient简介</h3><p>在JDK中java.net包下提供了用户HTTP访问的基本功能，但是它缺少灵活性或许多应用所缺少的功能。我们可以使用基于Http协议的HttpClient（来自Apache）来实现使用Java代码完成标准HTTP请求以及响应；支持池化（长连接）</p>
<h3 id="3-2模拟实现"><a href="#3-2模拟实现" class="headerlink" title="3.2模拟实现"></a>3.2模拟实现</h3><h4 id="3-2-1无参数Get请求模拟"><a href="#3-2-1无参数Get请求模拟" class="headerlink" title="3.2.1无参数Get请求模拟"></a>3.2.1无参数Get请求模拟</h4><p>客户端（浏览器）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*无参数的GET请求*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testGetWithoutParams</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">	<span class="type">HttpClient</span> <span class="variable">client</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line">	<span class="type">HttpGet</span> <span class="variable">get</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpGet</span>(<span class="string">&quot;http://localhost:8080/test&quot;</span>);<span class="comment">//声明get请求</span></span><br><span class="line">	</span><br><span class="line">    <span class="type">HttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> client.execute(get);<span class="comment">//发起请求并接受结果</span></span><br><span class="line">	<span class="type">HttpEntity</span> <span class="variable">entity</span> <span class="operator">=</span> response.getEntity();<span class="comment">//获取响应体。响应数据是个基于HTTP协议标准字符串封装的对象，可能有乱码问题。</span></span><br><span class="line">	<span class="type">String</span> <span class="variable">responseString</span> <span class="operator">=</span> EntityUtils.toString(entity,<span class="string">&quot;UTF-8&quot;</span>);<span class="comment">//通过Http实体工具类，采取&quot;UTF-8&quot;格式转换响应体数据</span></span><br><span class="line">	System.out.println(<span class="string">&quot;服务器响应数据是 - [&quot;</span> + responseString + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">   </span><br><span class="line">    client.close();<span class="comment">//关闭客户端</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span>&#123;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/test&quot;,produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;\&quot;msg\&quot;:\&quot;处理返回\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2带参数Get请求模拟"><a href="#3-2-2带参数Get请求模拟" class="headerlink" title="3.2.2带参数Get请求模拟"></a>3.2.2带参数Get请求模拟</h4><p>客户端（浏览器）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*有参数的GET请求*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testGetWithParams</span><span class="params">()</span> <span class="keyword">throws</span> URIException&#123;</span><br><span class="line">    <span class="type">HttpClient</span> <span class="variable">client</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line">    <span class="comment">/*URI的构建分是否使用?携带参数，以下为不使用?携带参数的方式*/</span></span><br><span class="line">    <span class="comment">//可以使用URIBuilder类来构建；或者使用HttpGet（参考无参数Get请求模拟），下面使用URIBuilder类</span></span><br><span class="line">    <span class="type">URIBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URIBuilder</span>(<span class="string">&quot;http://localhost:8080/params&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*参数传递分为单参数传递和多参数传递，二选一即可*/</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">//基于单参数传递</span></span><br><span class="line">    <span class="comment">/*buildr.addParameter(&quot;name&quot;,&quot;soul&quot;);</span></span><br><span class="line"><span class="comment">    buildr.addParameter(&quot;password&quot;,&quot;123&quot;);</span></span><br><span class="line"><span class="comment">    URI uri = builder.build();*/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//基于多参数传递</span></span><br><span class="line">    List&lt;NameValuePair&gt; nvps = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    nvps.add(<span class="keyword">new</span> <span class="title class_">BasicNameValuePair</span>(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;soul&quot;</span>));</span><br><span class="line">    nvps.add(<span class="keyword">new</span> <span class="title class_">BasicNameValuePair</span>(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123&quot;</span>));</span><br><span class="line">    builder.addParameters(nvps);</span><br><span class="line">    <span class="type">URI</span> <span class="variable">uri</span> <span class="operator">=</span> builder.build();</span><br><span class="line">    </span><br><span class="line">    <span class="type">String</span> <span class="variable">responseString</span> <span class="operator">=</span> EntityUtils.toString(client.execute(<span class="keyword">new</span> <span class="title class_">HttpGet</span>(uri)).getEntity(),<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;服务器响应数据是 - [&quot;</span> + responseString + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    client.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span>&#123;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/params&quot;,produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">params</span><span class="params">(String name, String password)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;name - &quot;</span> + name + <span class="string">&quot;; password - &quot;</span> + password);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;\&quot;msg\&quot;:\&quot;登录成功\&quot;,\&quot;user\&quot;:&#123;\&quot;name\&quot;:\&quot;&quot;</span>+name+<span class="string">&quot;\&quot;,\&quot;password\&quot;:\&quot;&quot;</span>+password+<span class="string">&quot;\&quot;&#125;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-3无参数Post请求模拟"><a href="#3-2-3无参数Post请求模拟" class="headerlink" title="3.2.3无参数Post请求模拟"></a>3.2.3无参数Post请求模拟</h4><p>客户端（浏览器）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*无参数的POST请求*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testPostWithParams</span><span class="params">()</span> <span class="keyword">throws</span> URIException&#123;</span><br><span class="line">    <span class="type">HttpClient</span> <span class="variable">client</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line">    <span class="type">HttpPost</span> <span class="variable">post</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(<span class="string">&quot;http://localhost:8080/test&quot;</span>);</span><br><span class="line">    <span class="type">HttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> client.execute(get);</span><br><span class="line">    <span class="type">String</span> <span class="variable">responseString</span> <span class="operator">=</span> EntityUtils.toString(client.execute(<span class="keyword">new</span> <span class="title class_">HttpGet</span>(uri)).getEntity(),<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;服务器响应数据是 - [&quot;</span> + responseString + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    client.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span>&#123;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/test&quot;,produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;\&quot;msg\&quot;:\&quot;处理返回\&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-4带参数Post请求模拟"><a href="#3-2-4带参数Post请求模拟" class="headerlink" title="3.2.4带参数Post请求模拟"></a>3.2.4带参数Post请求模拟</h4><p>客户端（浏览器）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*有参数的POST请求*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">testPostWithParams</span><span class="params">()</span> <span class="keyword">throws</span> URIException&#123;</span><br><span class="line">    <span class="type">HttpClient</span> <span class="variable">client</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*方式1:使用请求头传递参数*/</span></span><br><span class="line">    <span class="comment">/*URI的构建分是否使用?携带参数，以下为使用?携带参数的方式*/</span></span><br><span class="line">    <span class="type">URIBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URIBuilder</span>(<span class="string">&quot;http://localhost:8080/params?name=soul&amp;password=123&quot;</span>);</span><br><span class="line">    <span class="type">URI</span> <span class="variable">uri</span> <span class="operator">=</span> builder.build();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*方式2:使用请求体传递（对象）参数*/</span></span><br><span class="line">    <span class="type">HttpPost</span> <span class="variable">bodyParamsPost</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(<span class="string">&quot;http://localhost:8080/params&quot;</span>);</span><br><span class="line">    <span class="comment">//定义请求协议体，设置请求参数。使用请求体需要定义请求体格式，默认是表单格式</span></span><br><span class="line">    <span class="comment">//使用URIBuilder对象构建的URI对象，就是请求体传递参数的</span></span><br><span class="line">     <span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span> JSON.toJSONString(user);<span class="comment">//这里使用了FastJson</span></span><br><span class="line">    <span class="type">HttpEntity</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringEntity</span>(jsonString, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    bodyParamsPost.setEntity(entity);</span><br><span class="line">    </span><br><span class="line">    <span class="type">String</span> <span class="variable">responseString</span> <span class="operator">=</span> EntityUtils.toString(client.execute(<span class="keyword">new</span> <span class="title class_">HttpGet</span>(uri)).getEntity(),<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;服务器响应数据是 - [&quot;</span> + responseString + <span class="string">&quot;]&quot;</span>);</span><br><span class="line">    client.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span>&#123;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/params&quot;,produces = &#123;&quot;application/json;charset=UTF-8&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">params</span><span class="params">(String name, String password)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;name - &quot;</span> + name + <span class="string">&quot;; password - &quot;</span> + password);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&#123;\&quot;msg\&quot;:\&quot;登录成功\&quot;,\&quot;user\&quot;:&#123;\&quot;name\&quot;:\&quot;&quot;</span>+name+<span class="string">&quot;\&quot;,\&quot;password\&quot;:\&quot;&quot;</span>+password+<span class="string">&quot;\&quot;&#125;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-RMI实现RPC"><a href="#4-RMI实现RPC" class="headerlink" title="4.RMI实现RPC"></a>4.RMI实现RPC</h2><h3 id="1-RMI简介"><a href="#1-RMI简介" class="headerlink" title="1.RMI简介"></a>1.RMI简介</h3><p>RMI（Remote Method Invocation）：是Java语言的远程调用（基于TCP协议），无法实现跨语言。</p>
<p>RMI是从JDK1.2推出的功能，它可以实现在一个Java应用中可以像调用本地方法一样调用另一个服务器中Java应用（JVM）的内容。</p>
<h3 id="2-执行流程"><a href="#2-执行流程" class="headerlink" title="2.执行流程"></a>2.执行流程</h3><p><img src="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc2.png"></img></p>
<p>Registry（注册表）是放置所有服务对象的命名空间。</p>
<p>每次服务端创建一个对象时，它都会使用bind()或rebind()方法注册该对象。这些是使用称为绑定名称的唯一名称注册的。</p>
<p>要调用远程对象，客户端需要该对象的引用。即通过服务端绑定的名称从注册表中获取（lookup()方法）</p>
<h3 id="3-工作原理"><a href="#3-工作原理" class="headerlink" title="3.工作原理"></a>3.工作原理</h3><h4 id="3-1基础知识补充"><a href="#3-1基础知识补充" class="headerlink" title="3.1基础知识补充"></a>3.1基础知识补充</h4><p><b>Java IDL</b>是一种用于分布式对象的技术，即对象在网络上的不同平台上进行交互。Java IDL使对象能够进行交互，而不管它们是以Java编程语言还是C，C ++，COBOL或其他语言编写的。这是可能的，因为Java IDL基于<b>通用对象请求代理体系结构（CORBA）</b>，即行业标准的分布式对象模型。CORBA的主要功能是IDL，一种与语言无关的接口定义语言。每种支持CORBA的语言都有自己的IDL映射。顾名思义，Java IDL支持Java映射。为了支持单独程序中对象之间的交互，Java IDL提供了一个对象请求代理或ORB（Object Request Broker）。ORB是一个类库，可在Java IDL应用程序与其他符合CORBA的应用程序之间进行低层级的通信。</p>
<p><b>CORBA</b>，Common ObjectRequest Broker Architecture（公共对象请求代理体系结构），是由OMG组织制订的一种标准的面向对象应用程序体系规范。CORBA使用接口定义语言（IDL），用于指定对象提供给外部的接口。然后，CORBA指定从IDL到特定实现语言（如Java）的映射。CORBA规范规定应有一个对象请求代理（ORB），通过该对象应用程序与其他对象进行交互。通用InterORB协议（GIOP）摘要协议的创建是为了允许ORB间的通信，并提供了几种具体的协议，包括Internet InterORB协议（IIOP），它是GIOP的实现，可用于Internet，并提供GIOP消息和TCP&#x2F;IP层之间的映射。</p>
<p><b>IIOP</b>，Internet Inter-ORB Protocol(互联网内部对象请求代理协议)，它是一个用于CORBA 2.0及兼容平台上的协议；用来在CORBA对象请求代理之间交流的协议。Java中使得程序可以和其他语言的CORBA实现互操作性的协议。</p>
<p><img src="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc3.png"></img></p>
<p><b>RMI-IIOP</b>出现以前，只有RMI和CORBA两种选择来进行分布式程序设计，二者之间不能协作。RMI-IIOP综合了RMI 和CORBA的优点，克服了他们的缺点，使得程序员能更方便的编写分布式程序设计，实现分布式计算。RMI-IIOP综合了<b>RMI的简单性</b>&gt;和<b>CORBA的多语言性兼容性</b>，RMI-IIOP克服了RMI只能用于Java的缺点和CORBA的复杂性。</p>
<p><b>JRMP</b>：Java远程方法协议（Java Remote Method Protocol），适用于RMI过程中的协议，只有使用这个协议，方法调用双方才能正常进行数据交流。</p>
<h4 id="3-2Client-amp-Server"><a href="#3-2Client-amp-Server" class="headerlink" title="3.2Client&amp;Server"></a>3.2Client&amp;Server</h4><p>从现在开始忘掉注册中心，假设注册中心从现在开始不存在<br>现在我们的需求是这样的：client想执行一个在远程机器上server的一个方法。</p>
<p>我们如何做到这一点？Java RMI 会处理这些问题，解决方案肯定会涉及到socket网络编程，因为server运行在远程机器上，解决这个问题的关键点在于两点：</p>
<ul>
<li>客户端如何从处理网络连接中解耦开来</li>
<li>客户端如何能就像调用本地方法一样来调用远程机器上的方法</li>
</ul>
<p>因此RMI 的开发人员就引入了 Stub 和 Skeleton模型。</p>
<p><img src="http://fastly.jsdelivr.net/gh/SoulChay/figureBed/blogPhotos/rpc/rpc4.png"></img></p>
<p>所有与网络相关的代码都放在了Stub和Skeleton中，这样客户端和服务端就不需要处理网络相关的代码了。</p>
<p>Stub 同样也实现了和服务端同样 java.rmi.Remote接口，这样当 Client 想调用 Server 上方法的时候，就可以调用Stub 上的相同的方法，但是Stub里面只有和网络相关的处理逻辑，并没有对应的业务处理逻辑。比如说 Server 上有一个add()方法，Stub 中同样也有一个add()方法，但是Stub 上的这个add()方法并不包含添加的逻辑实现，它仅仅包含如何连接到远程的 Skeleton、调用方法的详细信息、参数、返回值等等。</p>
<h4 id="3-3RMIRegistry"><a href="#3-3RMIRegistry" class="headerlink" title="3.3RMIRegistry"></a>3.3RMIRegistry</h4><p>在socket层通信的过程如下：</p>
<ol>
<li>Server 在远程机器上监听一个端口。</li>
<li>Client并不知道Server 监听哪个端口，但是Stub 知道，这样Client可以调用Stub 上他想调用的任何方法。</li>
<li>Client调用Stub 上的方法</li>
<li>Stub链接Server 监听的端口并发送参数，详细过程如下：<ol>
<li>Client连接Server 监听的端口</li>
<li>Server 收到请求并创建一个Socket来处理这个链接</li>
<li>Server 继续监听请求</li>
<li>使用双方协定的信息，传送参数和结果</li>
<li>协议可以是JRMP或者 iiop</li>
</ol>
</li>
<li>方法在远程Server 上执行，并发执行结果返回给Stub</li>
<li>Stub返回结果给Client，就好像是Stub执行了这个方法一样。</li>
</ol>
<p>这样整个过程就结束了，但是等一下！回头再看第2点，说Stub知道Server在哪，他监听的端口，这怎么可能？如果Client不知道Server的host和port，他怎么能创建一个知道所有这一切的Stub对象呢？更何况是在服务端端口是随机选择的。</p>
<p>这就是 RMIRegistry 存在的必要了。RMIRegistry 可以认为是一个服务，它提供了一个hashMap，里面是 public_name, Stub_object 名值对。比如我有一个远程服务对象叫做 Scientific_Calculator，然后我想把这个服务对外公布为 calc，这样会在Server上创建一个Stub对象，然后把他注册到RMIRegistry ，这样Client就可以从RMIRegistry 中得到这个Stub对象了，你可以使用一个工具类 java.rmi.Naming 来方便的操作注册和操作。</p>
<h3 id="4-模拟实现"><a href="#4-模拟实现" class="headerlink" title="4.模拟实现"></a>4.模拟实现</h3><h4 id="4-1服务端接口"><a href="#4-1服务端接口" class="headerlink" title="4.1服务端接口"></a>4.1服务端接口</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义一个远程服务接口.RMI强制要求必须是Remote接口的实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">FirstInterface</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    <span class="comment">//RMI强制要求所有的远程调用方法(包括构造方法)都必须抛出RemoteException</span></span><br><span class="line">    String <span class="title function_">first</span><span class="params">(String name)</span> <span class="keyword">throw</span> RemoteException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2服务端实现类"><a href="#4-2服务端实现类" class="headerlink" title="4.2服务端实现类"></a>4.2服务端实现类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现远程服务接口。所有的远程服务实现，必须是Remote接口直接实现类或间接实现类</span></span><br><span class="line"><span class="comment">//如果不会创建基于RMI服务的标准实现，可以继承UnicastRemoteObject类。</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FirstRMIImpl</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">FirstInterface</span>, Remote &#123;</span><br><span class="line">    <span class="comment">//RMI强制要求所有的远程调用方法(包括构造方法)都必须抛出RemoteException</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FirstRMIImpl</span><span class="params">()</span> <span class="keyword">throw</span> RemoteException&#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">first</span><span class="params">(String name)</span> <span class="keyword">throw</span> RemoteException&#123;</span><br><span class="line">    	<span class="keyword">return</span> <span class="string">&quot;你好&quot;</span> + name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-3服务端主方法"><a href="#4-3服务端主方法" class="headerlink" title="4.3服务端主方法"></a>4.3服务端主方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//RMI的Registry在创建的时候，会自动生成一个子线程，并升级成守护线程。提供持久的服务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainClass</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">         <span class="type">FirstInterface</span> <span class="variable">first</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//创建服务对象</span></span><br><span class="line">            first = <span class="keyword">new</span> <span class="title class_">FirstRMIImpl</span>();</span><br><span class="line">            <span class="comment">//注册到Registry</span></span><br><span class="line">            LocateRegistry.createRegistry(<span class="number">9999</span>);</span><br><span class="line">            <span class="comment">//绑定一个服务到注册中心。提供命名，格式为：rim://ip:port/别名，命名冲突抛出异常</span></span><br><span class="line">            <span class="comment">//Naming.bind(&quot;rim://localhost:9999/first&quot;,first);</span></span><br><span class="line">            <span class="comment">//也可以使用rebind()方法，和bind()的区别是命名冲突会直接覆盖，</span></span><br><span class="line">            Naming.rebind(<span class="string">&quot;rim://localhost:9999/first&quot;</span>,first);</span><br><span class="line">            </span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-4客户端主方法"><a href="#4-4客户端主方法" class="headerlink" title="4.4客户端主方法"></a>4.4客户端主方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//RMI的Registry在创建的时候，会自动生成一个子线程，并升级成守护线程。提供持久的服务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainClass</span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">         <span class="comment">//代理对象的创建</span></span><br><span class="line">         <span class="type">FirstInterface</span> <span class="variable">first</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//使用 lookup 通过名字找服务，并自动创建代理对象。</span></span><br><span class="line">            <span class="comment">//类型是Object类型，对象一定是Proxy的子类型，且一定实现了服务接口</span></span><br><span class="line">            first = (FirstInterface) Naming.lookup(<span class="string">&quot;rim://localhost:9999/first&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> first.first(<span class="string">&quot;soul&quot;</span>);</span><br><span class="line">            System.out.println(res);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-自定义-RPC-框架"><a href="#5-自定义-RPC-框架" class="headerlink" title="5. 自定义 RPC 框架"></a>5. 自定义 RPC 框架</h2><ol>
<li><a href="">基于 Zookeeper&amp;RMI 的 Rpc 框架</a></li>
<li><a href="">基于 Netty 的 Rpc 框架</a></li>
</ol>
<h2 id="6-参考"><a href="#6-参考" class="headerlink" title="6.参考"></a>6.参考</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2c78554a3f36">深入理解 RMI 原理</a></p>
<p><a target="_blank" rel="noopener" href="https://paper.seebug.org/1105/">关于 Java 中的 RMI-IIOP</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1y54y187cf/?spm_id_from=333.788.video.desc.click">尚学堂编程俱乐部</a></p>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none"> 
      <div id="toc-footer2" >
        
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-RPC%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">1.RPC简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-RPC%E5%92%8CHTTP%E5%AF%B9%E6%AF%94"><span class="toc-number">2.</span> <span class="toc-text">2.RPC和HTTP对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.1.</span> <span class="toc-text">2.1具体实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E6%95%88%E7%8E%87"><span class="toc-number">2.2.</span> <span class="toc-text">2.2效率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">2.3.</span> <span class="toc-text">2.3连接方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4%E6%80%A7%E8%83%BD"><span class="toc-number">2.4.</span> <span class="toc-text">2.4性能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83"><span class="toc-number">2.5.</span> <span class="toc-text">2.5注册中心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="toc-number">2.6.</span> <span class="toc-text">2.6负载均衡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7%E6%80%BB%E7%BB%93"><span class="toc-number">2.7.</span> <span class="toc-text">2.7总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-HttpClient%E5%AE%9E%E7%8E%B0RPC"><span class="toc-number">3.</span> <span class="toc-text">3.HttpClient实现RPC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1HttpClient%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.</span> <span class="toc-text">3.1HttpClient简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.2.</span> <span class="toc-text">3.2模拟实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1%E6%97%A0%E5%8F%82%E6%95%B0Get%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1无参数Get请求模拟</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2%E5%B8%A6%E5%8F%82%E6%95%B0Get%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2带参数Get请求模拟</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3%E6%97%A0%E5%8F%82%E6%95%B0Post%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3无参数Post请求模拟</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4%E5%B8%A6%E5%8F%82%E6%95%B0Post%E8%AF%B7%E6%B1%82%E6%A8%A1%E6%8B%9F"><span class="toc-number">3.2.4.</span> <span class="toc-text">3.2.4带参数Post请求模拟</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-RMI%E5%AE%9E%E7%8E%B0RPC"><span class="toc-number">4.</span> <span class="toc-text">4.RMI实现RPC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-RMI%E7%AE%80%E4%BB%8B"><span class="toc-number">4.1.</span> <span class="toc-text">1.RMI简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">4.2.</span> <span class="toc-text">2.执行流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.3.</span> <span class="toc-text">3.工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85"><span class="toc-number">4.3.1.</span> <span class="toc-text">3.1基础知识补充</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2Client-amp-Server"><span class="toc-number">4.3.2.</span> <span class="toc-text">3.2Client&amp;Server</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3RMIRegistry"><span class="toc-number">4.3.3.</span> <span class="toc-text">3.3RMIRegistry</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.4.</span> <span class="toc-text">4.模拟实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%8E%A5%E5%8F%A3"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.1服务端接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="toc-number">4.4.2.</span> <span class="toc-text">4.2服务端实现类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%B8%BB%E6%96%B9%E6%B3%95"><span class="toc-number">4.4.3.</span> <span class="toc-text">4.3服务端主方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%BB%E6%96%B9%E6%B3%95"><span class="toc-number">4.4.4.</span> <span class="toc-text">4.4客户端主方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%87%AA%E5%AE%9A%E4%B9%89-RPC-%E6%A1%86%E6%9E%B6"><span class="toc-number">5.</span> <span class="toc-text">5. 自定义 RPC 框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%8F%82%E8%80%83"><span class="toc-number">6.</span> <span class="toc-text">6.参考</span></a></li></ol>
        
      </div>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&text=Rpc巩固"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&is_video=false&description=Rpc巩固"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Rpc巩固&body=Check out this article: http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&title=Rpc巩固"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&name=Rpc巩固&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/03/22/Rpc%E5%B7%A9%E5%9B%BA/&t=Rpc巩固"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
      <div class="footer-left">
        <!-- 网站运行时间 -->
        <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
        <script>
            var now = new Date(); 
            function createtime() { 
                var grt= new Date("05/06/2022 22:38:00");//建站时间 格式：月/日/年 时:分:秒
                now.setTime(now.getTime()+250); 
                days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
                hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
                if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
                mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
                seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
                snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
                document.getElementById("timeDate").innerHTML = "has been running for "+dnum+" d "; 
                document.getElementById("times").innerHTML = hnum + " h " + mnum + " m " + snum + " s"; 
            } 
        setInterval("createtime()",250);
        </script>

        <!-- 导航栏 -->
        <ul>
          Copyright &copy;
          
          
          2022
          Soulchay
        </ul>
       
      </div>
      
      <div class="footer-right">

        <nav>
          <!-- 导航栏 -->
          <ul>
            <!--
          --><li><a href="/">Home</a></li><!--
        --><!--
          --><li><a href="/archives/">Writing</a></li><!--
        --><!--
          --><li><a href="/search/">Search</a></li><!--
        --><!--
          --><li><a href="/about/">About</a></li><!--
        -->
          </ul>

          <!-- 不蒜子统计访问量 -->
          <ul>
                   
              <span class="site-pv">
                <i class="fa fa-eye"></i> 
                  <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
              </span>
              <span class="post-meta-divider">|</span>
              <span class="site-uv">
                <i class="fa fa-user"></i> 
                  <span class="busuanzi-user" id="busuanzi_value_site_uv"></span>
              </span>
              
            <script async src="/lib/busuanzi/busuanzi.pure.mini.js"></script>
            
          </ul>
        </nav>
      </div>


</footer>

    
    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?5322d3f5365b142e868c4e1fd7131329";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'SoulChay/SoulChay.github.io';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'Comment';
      var utterances_theme = 'icy-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":140,"height":280},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
